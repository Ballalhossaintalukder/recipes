source: clear
features:
- docker
services: docker-compose.yml
commands:
  - filename: docker-compose.yml
    content: |
      services:
        wings:
          image: ghcr.io/pterodactyl/wings:latest
          restart: always
          ports:
            - "8080:8080"
            - "2022:2022"
          tty: true
          environment:
            TZ: "UTC"
            WINGS_UID: 988
            WINGS_GID: 988
            WINGS_USERNAME: pterodactyl
          volumes:
            - "./mydocker.sock:/var/run/docker.sock"
            - "../.local/share/docker/containers:/var/lib/docker/containers/"
            - "./etc/pterodactyl/:/etc/pterodactyl/"
            - "./var/lib/pterodactyl/:/var/lib/pterodactyl/"
            - "./var/log/pterodactyl/:/var/log/pterodactyl/"
            - "./tmp/pterodactyl/:/tmp/pterodactyl/"
            - "/etc/ssl/certs:/etc/ssl/certs:ro"
  - sed -i "s|./mydocker.sock|/run/user/$(id -u)/docker.sock|g" docker-compose.yml
  - mkdir -p ./etc/pterodactyl/ ./var/{lib,log}/pterodactyl/ ./tmp/pterodactyl/
  - touch ./etc/pterodactyl/config.yml
  - >
    printf "Initial setup done! Please copy the config mentioned in your panel\n 
     to ./etc/pterodactyl/config.yml using SSH or Filemin\n 
     and restart this by calling 'docker compose restart' in SSH\n"
